# Show your Bankai | Medium | Pwn

## Информация

>Show your bankai to сaptain Kuchiki, maybe he'll appreciate it.

## Деплой

```sh
cd deploy
docker-compose up --build -d
```

## Выдать участникам

[Архив](public/bankai.tar.gz) и IP:PORT сервера.

## Описание

Проброс шелла с помощью ROP.

## Решение

Через форматные строки ликаем ret адрес, с помощью отладки вычисляем offset для этого адреса и считаем базу libc.

Ввод позволяет переполнить буфер и записать данные за его пределы. Мы можем перезаписать указатели в GOT, но не все функции можно трогать — например, если перезаписать exit, программа завершится, а если printf, то не получится получить утечку.

Поэтому:

- Локально через отладку определяем, какие функции вызываются после переполнения и какие записи GOT реально используются
- Перезаписываем только те записи, которые не критичны для дальнейшей работы эксплойта

Ну а после перезаписи GOT вызываем шелл и печатаем флаг.

[Exploit](exploit/sploit.py) тут.

## Флаг

`UralCTF{T3ns@_Z4nG&t5u}`
