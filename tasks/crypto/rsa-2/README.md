# rsa-2 | medium | crypto

## Информация

> Я снова написал свой RSA. Его точно не взломать.

## Выдать участинкам

Файлы из директории [public/](public/)

## Описание

RSA-шифрование с публичным ключом $   n   $, экспонентой $   e = 3   $ и зашифрованным сообщением $   ct   $. Уязвимость заключается в использовании малой экспоненты $   e = 3   $ и отсутствии padding'а, что позволяет извлечь кубический корень из $   ct   $, если сообщение $   m   $ достаточно мало ($   m^3 < n   $).

## Решение

Принцип решения:

- Поскольку $ e = 3 $, шифротекст $ ct = m^3 \mod n $. Если $ m^3 < n $, то $ ct = m^3 $, и можно просто извлечь кубический корень из $ ct $, чтобы получить $ m $.
- Если $ m^3 \geq n $, то $ ct = m^3 - k \cdot n $ для некоторого $ k $. В этом случае нужно проверить $ ct + i \cdot n $ для небольших $ i $, чтобы найти $ c $, из которого можно извлечь кубический корень.
- После нахождения $ m $, преобразуем его в строку с помощью `long_to_bytes`, чтобы получить флаг.

[Решение на python](solve/solve.py)

## Флаг

`UralCTF{Thats_why_the_pad_is_neededbla}`
