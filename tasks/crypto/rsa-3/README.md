# rsa-3 | medium | crypto

## Информация

> Я опять написал свой RSA. Его точно точно не взломать.

## Выдать участинкам

Файлы из директории [public/](public/)

## Описание

RSA-шифрование с публичным ключом $   n   $, экспонентой $   e = 3   $, и два шифротекста $   ct   $ и $   ct2   $, соответствующие сообщениям $   msg   $ (флаг) и $   msg2 = msg \cdot 256^{|pad|} + pad   $, где $   pad = " from Ural"   $. Уязвимость заключается в использовании одного модуля $   n   $ для двух шифротекстов с малой экспонентой $   e = 3   $, что позволяет восстановить сообщение через нахождение общего решения уравнений с помощью НОД полиномов.

## Решение

Принцип решения:

- Первый шифротекст: $ ct = msg^3 \mod n $, что задаёт полином $ f_1(X) = X^3 - ct $.
- Второй шифротекст: $ ct2 = (a \cdot msg + b)^3 \mod n $, где $ a = 256^{|pad|} $, $ b = $ `bytes_to_long(pad)`, что задаёт полином $ f_2(X) = (a \cdot X + b)^3 - ct2 $.
- Поскольку $ msg $ — корень обоих полиномов в кольце $ \mathbb{Z}/n\mathbb{Z} $, их НОД должен быть линейным полиномом вида $ X - msg $.
- Вычислив НОД, извлекаем $ msg $ как коэффициент с противоположным знаком.
- Преобразуем $ msg $ в строку с помощью `long_to_bytes`, чтобы получить флаг.

[Решение на python](solve/solve.ipynb)

## Флаг

`UralCTF{92c4770804563ee0b3a3b935f7bc7226a14710c84e9d8f27e8daedb7a8ad73c66d4e7029a5dfcb923ccac697a45fe65882ea9231476f7d8d0a8afd96a8e9e1d3}`
