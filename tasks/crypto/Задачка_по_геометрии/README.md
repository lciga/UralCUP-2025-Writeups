# Задачка по геометрии | medium | crypto

## Информация

> Решил вспомнить школьные уроки геометрии и написал простенький шифр

## Выдать участникам

[Файлы](./public/)

## Описание

Шифр, основанный на гиперболической геометрии и дискретной математике. Шифр использует свойства гиперболической плоскости Пуанкаре и конечные поля для шифрования сообщения

## Решение

### Анализ алгоритма
Мы имеем поле $\mathbb{F}_{251}$, то есть все вычисления производятся по модулю 251, также имеется матрица $M = \begin{pmatrix} 3 & 5 \\ 7 & 2 \end{pmatrix}$ и $k = 42$ - количество итераций преобразований.

Каждый символ флага преобразуется в точку $(x, y)$:
```py
def char_to_point(c: str, p: int) -> List[int]:
    val = ord(c)
    return [val % p, (val * 2) % p]
```
К точке применяется матрица $M^k$ - матрица $M$ возведённая в степень $k$. Зашифрованная точка преобразуется в символ используя только $x$.

Чтобы расшифровать флаг, нужно:
- Прочитать зашифрованный флаг и параметры
- Вычислить $M^k$ в $\mathbb{F}_{251}$
- Найти обратную матрицу $(M^k)^{-1}$
- Для каждого символа флага:
    - Преобразовать символ в точку $(x, y)$
    - Применить обратную матрицу к точке, чтобы получить исходную точку
    - Из полученной точки восстановить символ

Для реализации решения напишем [скрипт](./solve/sole.py)

## Флаг

`UralCTF{0MG_tH15_15_g30M37ry}`

