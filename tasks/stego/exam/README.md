# Экзамен по стеганографии | Easy | Stego
## Информация
> Ну что, товарищ студент, хоть на экзамен вы соизволили явиться.  
Тяните билет, но за каждый пропуск лекции я вам накину дополнительный вопрос.  
Не ответите — на пересдачу.

## Выдать участникам
Архив из директории [public/](/uralctf2025/task-developers/tasks/-/tree/main/example/web/example_task/public) 

## Описание
Матрёшка простых задач по стеге: часть флага в binwalk, часть в метаданных, часть: архив внутри картинки, мб что-то ещё придумаю. Сами по себе решения не сложные, но они охватывают спектр навыков. И апогеем: зачёрканный белым QR код который нужно будет ручками собирать, т.к. там остальная часть флага

## Решение
Задача сводится к применению простейших инструментов по графической стеганографии

Имеем шесть картинок "question" 1-6 соответственно. Уже хорошо, флаг хотя бы упорядочен)

1. IEND
	- Заходим в любой HEX редактор и просматриваем поля, которые PNG не читают. В начале это перед `%PNG`, а в конце после `IEND`. Собственно, там и видим первую часть флага: `uralctf{th3`
	- ![[images/Pasted image 20250914174638.png]]
2. Работа с цветовыми каналами
	- Открываем картинку в любом анализаторе или даже графическом редакторе. Как вариант, StegSolve. Покрутив варианты замечаем что на Blue Plane 6-3 и Full Blue на браслете заметен второй кусочек флага: `re_is_s1mp`
	- ![[images/Pasted image 20250914174842.png]]
	- ![[images/Pasted image 20250914174849.png]]
3. EXIF метаданные
	- Прогоняем картинку через любой анализатор метаданных, например [[Exiftool]] и находим много всего интересного. Но нам интересует даже не `uralctf`, а строка `Artist: le_st3g4n`
	- ![[images/Pasted image 20250914175220.png]]
4. Архив в картинке. 
	- С помощью, например, утилиты binwalk или strings прогоняем файл и он нас наводит на файл `flag.txt`. Далее любым удобным способом (хоть в 7z) открываем файл, видим что он открылся как архив. Внутри ещё кусок флага: `0_m3th0d`
5. Обрезка изображения
	- Внизу виднеется какой-то текст, но как его прочитать? Снова открываем HEX редактор и читаем (либо нам подсказывают нейросети), что после IDHR первые четыре байта отвечают за ширину изображения, вторые четыре байта: за высоту. Или высчитываем или методом научного тыка меняем байты (как вариант, 02 на 03), и видим кусок целиком: `s_3very0n3_5h0u`
	- ![[images/Pasted image 20250914173149.png]]
	- ![[images/Pasted image 20250914175706.png]]
6. Final boss.
	- Зачёрканный QR-код. Бог вам в помощь)
	- На самом деле, восстановить его не так трудно как кажется. Нам необходимо лишь из целых элементов узнать следующие параметры. Размеры больших квадратов: 70x70. Размеры маленьких: 10x10. А затем используя фотошоп, или GIMP (или хоть Paint) собираем повреждённые участки. Первоначально лучше начать с восстановления больших квадратов, а затем перейти на маленькие. Начёркано так, что нет квадратов, которые закрашены полностью, так что при желании за пять минут можно собрать QR-код в читаемый формат (Кто не знал, QR может быть немножко повреждён :) )
	- И да, нейронкам скармливать безполезно, они генерируют какое-то подобие QR-кодов, но это даже не читается
	  Так или иначе, получаем последний фрагмент флага: `ld_kn0w_1t}`

После стольких лет... я собрал все ~~три~~ шесть
`uralctf{th3` `re_is_s1mp` `le_st3g4n` `0_m3th0d` `s_3very0n3_5h0u` `ld_kn0w_1t}`
Ну и собираем весь флаг

## Флаг
`uralctf{th3re_is_s1mple_st3g4n0_m3th0ds_3very0n3_5h0uld_kn0w_1t}`
