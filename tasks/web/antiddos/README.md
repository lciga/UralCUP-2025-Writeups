# AntiDDOS | easy | web

## Информация

> Опять нас заддосили... В общем все, плевать на метрики и клиентский опыт, главное, что прод стоит. А стоило всего-то ограничить всех клиентов одним соединением раз в минуту.
>
> http://5.1.53.43:5096/

## Описание

Сервис принимает первый запрос, а дальнейшие блокирует на одну минуту. На самом деле сервис разрешает установить первое TCP-соединение и блокирует создание других на одну минуту, Можем переиспользовать одно соединение, чтобы пользоваться сервисом

## Решение

1. Из описание понимаем, что можем создавать одну сессию раз в минуту.
2. Создаем TCP-сессию (например, с помощью, requests.Session в Python) и переиспользуем ее для всех своих запросов.
3. Регистрируемся на сервисе, создаем заметку и переходим к самой заметке.
4. В URI видно, что у нашей заметки есть числовой идентификатор, попробуем ввести туда другие идентификаторы и поймем, что у нас есть IDOR, так находим заметку с идентификатором 1 - заметка с паролем админа.
5. Авторизуемся под администратором и получаем доступ к админ панели. Тут ничего примечательного, статистика по пользователям платформы. Однако, мы можем выбрать статистику по конкретному пользователю.
6. Выберем случайного пользователя и заметим, что в URI передается параметр user_filter для получаеня данных об этом пользователе. Пробудем подставить кавычку и увидим ошибку с указанием самого запроса.
7. Подбиваем пейлоад, например, `/admin?user_filter=1%20GROUP%20BY%20u.id%20UNION%20SELECT%201,pg_read_file(%27/flag.txt%27),1%20--%20-` и читаем флаг из `/flag.txt`.

## Флаг

`UralCTF{r3us3_c0nn3ct1on_t0_byp4ss_1bcf3d}`
