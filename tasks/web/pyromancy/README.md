# Pyromancy | easy | web

## Информация

> Какие-то очередные "стартаперы" предложили нам внедрить их решение. Надо бы проверить его на безопасность...
> PS - название файла flag.txt
> http://5.1.53.43:5645/
> 5.1.53.43:5643
> 5.1.53.43:5644
## Описание



## Решение

1. На сайте заходим в документацию, где видим использование Pyro4, отсюда же видим список открытых функций.
2. В документации к Pyro4 можно найти инструмент pyro4-nsc, который позволяет делать запросы к Pyro4 name server-y.
3. Используя `python3 -m pyro4-nsc -n 5.1.53.43 list` получаем список всех доступных интерфейсов
4. Видим интерфейс `Private`, по аналогии с публичным интерфейсом можно запросить информацию используя метод PrintInfo()
5. Среди методов интерфейса замечаем "DisablePickleCheck", который отключает проверку пиклов перед загрузкой, но он работает только от админа
6. Используя интерфейс `Public` и метод `CreateFreeUser` создаем новго пользователя и получаем его токен.
7. В GetObjectList есть UNION-скуля, эксплуатируем ее, получаем токен админа
8. Вызываем DisablePickleCheck с токеном админа
9. Делаем базовый pickle-payload на ревшелл / отстук через curl и закидываем
10. Вы великолепны - читаем флаг!

[Решение, с помощью Python](solve/solve.py).

## Флаг

`TyumenCTF{3mbr4c3_7h3_fl4m3}`

